using Microsoft.AspNetCore.DataProtection;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Http.Internal;
using Microsoft.Extensions.Options;
using Microsoft.Extensions.Primitives;
using Moq;
using NUnit.Framework;
using System;
using System.Collections.Generic;
using System.Text;

namespace CookieManager.Test
{
    [TestFixture]
    public class CookieTests
    {
		const string expectedTestString = "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";
		private static Dictionary<string,string> cookieRequestHeaderList
		{
			get
			{
				var cookieHeaders = new Dictionary<string, string>();
				cookieHeaders.Add("cookiemanager_1", "test1234");
				cookieHeaders.Add("cookiemanager_2", "test794745");
				cookieHeaders.Add("cookiemanager_3", "WdnDCMLzHaByzFYAkAntuzM9xqHjq6s7Pe1JmHgu7U1yTbzQuP");
				cookieHeaders.Add("cookiemanager_4", "24861ljbggh");
				cookieHeaders.Add("cookiemanager_5", "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");
				//chunking cookie data
				cookieHeaders.Add("cm_key1", "chunks-2");
				cookieHeaders.Add("cm_key1C1", "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");
				cookieHeaders.Add("cm_key1C2", "bwQbhYWs1yT36FaS3xVD16egInievyM2kWXjsgQRC3aWUvq3cq6wnI8hffXSGrRAGJ46JPUm0gBlWgXGoQWvQiKkz75CU5lvY643qVP68KQetff8E683geD523g6i3Qxa3V9dJRRP0uuCcC57W2AN7oWHf4OdDuNHNXQEd81n5QsRolGfjFP2GqJnprfHm9eX4pETsM0Rmdlwf0SFFThzgNn74WsJBB6HpNXlkfwJGM2sJM1xpzFJxHMLn0iQyDlXngRad3ttjqxkgwHHHArTRT0SCzdHYEcauiVuIZJVAHmOgy3WGilzRhLBQUdBYAPO3eO07whkuQhuN0rKQIsAgKAuBLwrMzYz38nejxJdA5mBnAqf0eoxBOVFnyGcCtQXzgM1GJT5hrx0yPzaq4ES1I3T0jTj5xtF2PJiZ2ZMO4iHhvvDQyIwy2ilLJdVKv02Nnr1H4IDB0xSLCvfDLVztw43C1SteP9KPiGSJiPjBkjsggTyBa44jARVZOMISZdda0he2TYFPYZkEuHxwjWpzfXLFil0pCnp8T6DgkEkPtgNeWRWFqhN3Y8f5gkomifSOtgeLOcKVaaPrD4e4pw1CvHRbxMrN0KneBpzzznkrAfyTXyuDAqAelfAm1qtmAihWk3EaqeGlgfj9ZfhI9IKr6V6IBUn1qt3OhX837Ta9mLrMtYfgmAw93UJv9hsyRRO50LD2VlwEMwgesv9uAjQUMI4KD008MKEqSbDrPh0iVf4bkaZwrSOZaFQBkTBazgHhd5RqG2l63dk9dMk8CWj7ipd3Z42UQd1dv5kv7HF44d4T326UX7MwXBIoUeIUwA76cAKsELdjkNBAy0NPoy0iym1bo4lWjzb3URTHA3MLkbOiAFi68Q4Tv124dl7LeRC4e6WsvOy89bL3txsrQ7Y4JAZ6xsRJdCSxAwakvF7xWAjGnKBrx2aZAmEgeyvyAEECzdITLArm3OvU9WKKlMd74244iOZaAQcSLh7ct1vd27XNms");

				//encrypted cookie data
				cookieHeaders.Add("encrypted_key1", "chunks-3");
				cookieHeaders.Add("encrypted_key1C1", "Q2ZESjhHblBqOWFrOHQxSHBoWGE4bU1iSW9LbnF3NFlQdFhPWG9LYXN2bW5QRWhLRFdrS3JlR1JZek9iWWI2bnNZajZ6Y0lJaXl1cVdNaWNfbGZ3TGtZdi1ZLUlJN2hlR3ZZeDBmZk1TU0lWRDdKS3JzWDlNTDc0SnUydm1GUG5oVHRpZmJuRlFCclVibHVoSjJQbjM0djNhbkFYSGRZUlRoMllseUpoSjNvSkRVcnVfNnhPXzdFTTlVSmR3eFU5VkpPZjBOcENoWnlwUjlBYTY0SlFYNENMeDhpNFN5MDRnenhzS0t2U3EwVEFDTmxZMVJ1Vzhmb2R1MjNvc0ZJc0lkUTk2RzJ2SVl3T3l1ZUZVWEEydGNMQ3VyYnRtMmtRR2dxdmlaWm9CUU5kZml3VGp4dzZkdlc1ZjlNbUpIel9YcGJRQ1lpRVU4a0cxNURreVdnbHZxMDA2QzZBOXhjQ0d2aTZGaTBfT3cxZ1Zod1Nkdkh1bjdNOXZwTkY5QldvamRwZE93VEQyeTluU2pnM2FkVTFJUm1sLXpaeFBKMExWSUNWUTB5WjFabmJxV2ZNeFNWdWVvZUVHVllvSXU0aF9FcVQtWTZZcW1TeDAtWjV5T2pLNUFKYXVBUkZvVS01aG82eUNTVUlnX3NkYmhrUmVjRk0wb0NocWZDRnZqUGxfVDJpclRVazJFTzk0RnJDN1RHWi12TTdWUHMyRjRfSjdUZDJJeWFaQnZ3eUdGTDZBX1hwOE1Hb09vQWdXVWdCTDR0LW84SnNjT0xnVnJHeUJmZlF0TTkyc2c2YnNxRW5yeGVyTzRzRTFRVHhERl9UcENENXNMS010YUYzTkl0dWtPZlZ0OURQYVRWOVRIZ3VlNkxWSkZhc290cXY2YjlVT2RfbzJUcGFfWkIwTEh4aGRaTlJIWVJxRjBIY3lDb2hwaHNSSUo1aENQNU9zN0RJVDhpc3lZa3NfWlhLRW1GZDdUS1RSRVZvdU8zVDFFUHgwYkRWX3FGR0JaclF1NlZfdXliZjdnTms5Q3JuZ2UyRWtqNkVsWGdQSXZpYXVjN2VkS1ZuUHNUUnp3RHNPWU4xTldnay1VR2tLRmpJU0NyRV9Va2FNbjhGNi15MnVtZ1ZKVGVibWFwLU1jelpxNmVpbEQ5cl83YURTSnlaQklaUFkwUWRHU0psTHgzQ1l5U1RKMGZzb3ozdDVzVWx0MWN1QWVXbmc2b2lFX2lqMHdiVWZyaVA4WUUxbUY4UkI4aFNRdFZYQzNLSDhfdWtQMm9mRXVlaHp2bV9OVFJ4NXlLbHM0bmtmbnphVXBmVTNWWXZWVUl1TFduUVk1eGVDbk4yeG4xUWdrbGJmdl9YeDMyWkVLQUdtbTZIeEtrcWxyejh5LVdGVWRyWWNJNG5nMkVKdnZ0MEIySVVvcENMX0RQRUFoNHNYbUV5MHBNX1lPdE9WX21DSDRlTXVwS0FEMHRxQnVURnJZZWI4NXZzTnFlNFNPS2tZVElEODNLdFZ4WjBmQ282WjRHZDZrTEhRNFRRUm9rVm5rSGExYzlWSHJ6WktJNm95MjN1R3dBeVZHbEZ4VEs0bE02WGcySEJqb19BWXJ4ZzVINlliM0tiMU0xODhoSW1Ydlc4cTZILUM3TE13TTk2NkZHVHYxa09ZWUNQRnhMLTQ4NzZVemlVY0F3N2hRR0FveENSWlFWT21kNy1LOER0UVNlSTRjdFJ6YWdoZHVNbFlBYnFHNXM1WmVyaFVGLTFKYm8zZDRSVE94WGRlSDlsOEQ3U3QyV2ZIbjFhT2JpdFo4dFB4WTkwVjR5NVltT1FiQzI2N1c5UWFRVVQwcGN3N2VzNlNaRGJyTm14cDZrdHp4bjM0cWNBa0lObUJuTVRKS29obDd0WENzM21Kc1hjN21wRWVlRmp5NE5YYThmM3BLS1FfaHY0UWtmbC1nT2dmbkZUUWU2dEQ5VkFRTWRVUWJqaF9SNE5vS2FSR25SUVRIU1dCbjRkSEZRU1d3U3lzaEhidnlxOHJYQjRlUmJCMXliNVdENEJkcFdWTmEyZDJrMk5VMWpaeV9GSTRTWm9Lc08tSDVnUGwzajZ4bnZ5azIwc3diQkUyUmRMR19TR0VXVU5NWVVkSkVPeGdIN0ZDM2Ftd2gzLU1HaHh3SjZtMG1hR3VrSUxfdUFqYkg3Tl9ZdDdwZjFjNVdOV2JmUUVHa2h3M0tCSWZfdnJicjRVU1p0XzB6R1d2Rk02NElYdkpsOEQ1Sk52c3VWbE9ycmloZnYwVE1qaGNtRmluWU00MEZTVmczUjlxa0dISy1rZnRmWUN4S19ob09yeGtFVEVjTlpmY0U5c2dyNUYyYWJYcURNX25oRXhGMzVickV0M2pyTlJKYjVEVEZWOURWN1ZpZFFmZWM4cWpGLWM2VVRvc29hNmhna0syTENlcmlaN3gzb2xGamtlVVNXNTAxYllEREVKamNwaE1BNW5yMUhLc3VQdDFDOU9SM081VWhQd1JfcXVZS1FSbmJxdlBiZmxqS2xCSXkwcnpWVVZWRW9aejU4dnBvREM5NmRpLUwtVFJMVVZQRmx1a1k1azQzUDVtRkxSa1dpTVozR0Z6ODhxZE9LTV9BdFBkYy1WaTRyNzdoLWZkenZ0VzVzQmlCUTU0VmlBcUhXNTkyWFJWalFaSHg2X1VGeVQ5cnFWZ1ZnalNuX1BBSjlOcXYtMVM0VjMwRFQ0UW1nWWhMYl9VVzhveUI3cTRkQVhQaVFXejI2TFJrUFJSLTkzZmwtWGlJWVRtMFRNVHYzeVQ4cDUxU2w0TGFQbUp3bFBTc3pQZ3ppRW5aRVQxeXBYM3hNYUo4b0lCRWFrazV1QW52ZFRvSGludElONmEzejZMN0FvbjBEbEV2ZnJVT3ZmN2NUWHREcmZySngtNk5YN0JrajVXMlIyNF9RRlRSLXJzdDZnWE5RSnpCQ1U5SDVtbDltOFdWYXBXWDI1ZzRvQURTY2ZnNzJGaVRBSEJMbjJUMWxDMTZZbmNpY09Mc3lLMmp4dlh0SjcxNkVDcTZiM0x2Nmx2dUhrQl92V1FZU3BSQ3NuSm5tRGpXZWJVYW8xMVdocHdhcWdEaUR5R0FnUXBzU1dLZE1jaDhocFNLOTkxMUxXSWMyOWxYb3p3YjczaWdJdmVrR0tJWlJFUjlaZHhGaUVuRjVTZ2dReUNodldzTFctU1NTeWFLZDVudmNMTzRQQ0pUakRBbGt5bTdGSVpXcEh0cUd2cl93R0xQcV9vRlE2bnN5MUFXbjhnZzZmVmQ2Wm40aHF2YW44X0ZFd0p6NDRVVFhKb0c2c19JSm5zNFNiaXZSeU5ueUJ5ZkdQcjh5dHpEVVEwZmNDbXRFSkFCdTlTTnI1NzVxOS1ZdVpyLTZxYTViekRNdHQ3UEFxU3ZyY0k3ejJJV1c4cXVLbWY1d0RfdTc0ckN1VmZRazhhTHhxeEJiLXlvSngtT0doV01BSE8xU3hsNXdXX01La1llSnZ3SmpDOXZPYW5nMWFxX1JjcGIweG5QRXo1dWhqSklVaXVnRmRwTDM0LW1qTnlBNGRYUkhzSGlVdU9PSFRnMnRZbnlhTFo1TG0xd2ptanh2MVBUM2tzMl9kMTdRSGpiQmlxdUUxQnozazJrMEtNdnJsOVBGcXJ2clZ4QmRVcThBRllJLTQzWHBBdUpHdTJRcHhtRmNUVHoxZDVNS2dDZGZYMmhxWDN3YmcwZWhVY0VFR0hrWkUwa2pPY25PcjJNR2JfVTlydXRFWXk0bm1VV1NJRXVickJWRlNJSjF2WFV1YTBqNy1xOV9aYzdwZXIwOGFrRUdxQ014eHpUWHNXeGdBQWV0RmItWC1QS05DMDNTQzNLaHJGdlp1N1ZsUkpVZXRPYjc1VmZqaHRwdjlpU0tSaHZubE9TRG1raTVpQWxQN2pWaVFkWkNlUUdJM2pTUzQ3MzRkblJiQjQ0SjNXdXN0a0s1c2ozM28wVTdnT1dUdVh0");
				cookieHeaders.Add("encrypted_key1C2", "bTJLcVREaGpNUFU1LUZkeEtLVlZkOXU0U0Y3MVBQMmFOZmlZdjRWMTRrQUI0SVZWM3FqSU56M1hVZFBSc0pLM0M4WG9OZHdKZVpUSnZRR0NJa3c3d1hOZlRDNWk2MzRjN2M5OENUNlgySTRkLXEyczhIdmpMUkQ5Z3ZURVVFLUUwQTRHRU1XaEZ3Q3FmaFIwTWZSbVlLby1PSnE2Skd6Nlo2UXFvbE40dG9UR2pCSlZVaFZSTUtUeWc3ZzVmSmNqWVFQTHAzZ09McHNMZDJ6MHNpbFAxakg5Tk1JODVlR2Y1X1BwN0RTQV9hR2l3UjZuZnpnU2VySld5Q0xIbFVISzBfdkx6MHMwckIydTR4dHNkdHRaMUplSVVxbEhIY1Nva3p4VExuM2NBWjRRZmp1Zk1PaVdOeGNTVUtSZHQ5Zk1DVzRBN25jVkVKcHJhTGtKY2ZFWWlFNVhWUE1fY1lMME82Y1pRZGtKTG84UHNzSWlWejdWV0hNNm5mbnFWYjJJTFFmMGNjdVM0X08tSHJQbzR5TU1fVHg1ZVliVlZYZXNZVUVkUThmUm8zNFNxRlQ3aTFwNWg4a1JKR1UyeEJTVXp5S1RReFp5enVYcW9XNW5TajlGTXlySHAzaGJhd0tWWWJBY1g3X19HZFo3TGpWV2lNdlJEamhMVXB2ekdVU0JOTFE3T2VBTTEtRWxHd1h4eURfVF9IV3h5a3BsN3EwbTFGNmhuVS1qMUtnNHpNRm9QU1NFWXFsUXh4X29kUnJ2emhmcTJFcGl5VWVUODJWX1Bqa0lWajQyczNTRVlPcVR2TFd3R1p2VEl2THNFelVYNHZNb1NqcFdIM1pCTlQtbVZ3N0VZX1FSeFRlLXJ1Z2hqY2N2VXRTM1hCcXVNZk50N1VHVzdoV1dZVWVGbXBiYmR3eTRnV2FPSDNOQ3VvbS16b0hFM1hjTnJUdmFtZE5EbmtvLWd4TUR0ZDdiOTBSYnpkLU1DWHVrUzZxRnFhNHNlUEZZM2RyTW1nRDF1ei1SaHRpM01ydFNqQzlqaUN1OTh2UUtKdWxmMDYwNzlYZUpmZk1DY0dJeWs3R1VEX2pmRkxWZUo0eUszY2hUejkwbzVQb1M3bHB4cWJ6VFRXQm9XWkE5VGNXc3BYbU9UbTJwNWc0OVlPSEhmRGZZUnlqWENEREpQbmF4UkJIWXJvWnJ3WlA3TmpzT1FUVThYWkNUbW1aaVJlOUVNbkdKSkJvN0I0dktLYk01em1qM2N6cDl5ZHdPZlFhbVN2TTFfWWRmVnlic2ExbXBmeklYWV94TWVuR0J2VHhDUXNaRXNoaEFjb1d6QzFYMVpvTXppbExHeGdFY3Q3MHVYenN1SzkwSFp3Ykl5eW5tZTAzaFRLNGw0dlRIMXFNakJOdGktVm5oeGlIV0tmMXpBalJqN2ctaXNsR0RSZ2Y5bW9zNXd6SjBfRlJvYkNFSVN1aGhLU2szS3FOQ2Q0ckNBeW9KT3pfeXc4YUlTUF9EekhtQ3pFU2RWN3lrdU90cWpBZmtPRERMMjlSeU1FcFI4MVFfaWhvRC1rSW9yOHhpNHBOZXZBbXFwcjZFTVlONHN3ZWlINlNzWlNlaDVmQ0RVNU1NUkl4aXB3NXctXzliVTZBOVhCd1lUZTVBYkNCZmNhdWlDbkd6UzdaUDBVeHlnN2V1VDI2NTJVNlF2Y1RuMmxoSGxvdkw3RkNNczE5bklYc1RCa2dOVmRIbEg3cm1fTWkxVkFXX2xxQkJJN3JWVjBqdUtJVHZaSWVVcmtqZlZPaGgwWmRlWDBkVmpwX1dQVTJCaW1XaVprX3JXRzk4SlNJM3pySkZBeUpCVGoyakllZnp1ZUU2a1NrUXVjM085dVVaV2ZwdExrbW1SY0tUd1E4cGlUZFFhZ1d4SVpfcE5PSm81Y0xrZUxuY2JBMm5iUWZ1d2RORmhwck5zNjVNWWEzUTh0WmJ5OXNBdmJxZVkzbzN0MVE5Wk9GMFRORTUwOWtwY2VaeWFXVTM1ZXVsSzhtQTNWY0d5VEdCY054dENpaDhUMGQxUk56VXpsYXFwZ3JzUFpFZUxKdVM2WEJyMVRQZUxNT0tHSTRhMmdkc0xLQVU3Q2UxckFRLUJCY1l2X1JTX1lzRkxfRnlIU3IwUVR6RTMwMS1UUGFvd2NKUVFiN2JURGFGZ0ZjOWJ0dERWcE9VZ202WmgyMC05MWFmMkhJdzJILUJWam4wWTd1QndGRUFEbzluSVUyY0N0V2VsdnZNekdxUmVCV1hSc3IycGZ0d0p0YnJab3pNZjJlU25peVV6WFhkN3pZUWFTYy1Xa2llamVJQTlxdXZLdmF5YksyUlZsZENxUF9URjhTYUJwRHJtYm9heEZHYVN3ZHNjNkw1X2Fwd0xrdjNNeFR4MTEzSjFOcXFDaW5ZS3hqV3NOVjZ3SjJOTGlKZEV6QmtibHdOU3dTd2YySlZmekd2Y1NFRWZIeGROaFh2UHM3dTNpcWUxVTJoREN5RDgyR2lzbU5oV3NkZDhrNVd0dko0NXJscnE3RjJFUkNlMzNscWpJcDdQd1hqaFdwZkE2V0k5T001WWhuYWs1S3YtbFdRTVZud25yUW5Pbjd2Zm53NUR3SXRHZ0FLRnRkSHlZU3psMGJSQl90NFJiNEs4VGRWSTN2ZmFUNmFQZW1ySGI3SUhHUWhGbFJCY2VGRFEwNm5KVTlsdm16MGxLaFhzLW9pN0VzV1NlMktHRkhJVTc2RkVpVFFFZlFtRElhajF0ZFhxckRsQkJWTHBpOVc5UFd0UWZRamtHUUVtTHJpbG41TVJybXdEN0JBcXdfX29pQ3BrZWJnT05ScDFwTnZTLVRlYnNtelhncmxyVlhIQ2lLSnVMdURfZE41TGtyOG01WFNSb21xai15QnpWbENIdFpURWtEaFJpWjdoemNIVEU1OGVKckZvcm96eU1NemtnbzRyaTlNNGdXT3g4RXpFNTRYbWh0UnZRdTFJekxfTzN5QkRReUFyanFTNnhVY3ZfVFZsYzlnV3NDcjNJMlMwQTdDN0VHZTJKODE5NVkzNjNBVC1nN3RpeDRDeEtHc2VFSFk4U01ydFNnbmdFMDB3aXFzcnU3UjJYTVc0UWpBWjEzWkJPVGxxZl9xYjJEQURYS05WbDdoRmxjMjdHeVFDU2locmlLSlk1UC14aXpGdXEtT1N0T3JLVDdWcXlwUDVfaEU4dU9VMHYyMms2dHphblU3eGRlREY4czhTOXJ3NnRLZGVhMDM4amJyNzJKOTRWOUtSWHdId29QOHpzZnczbWJTUE14cmtFQzBELTdVbWtqUU1jT1lIYVduNDBjd3RVWDdCNmdSVTkzQVF5N3NhOHJPZG9OSGJyTmJ1dVNVbXdJTXdRbjBURUJHNlpER2VzSW43eUtlQm9wVWlwLU1BemgzUHJIUThoWVozMmhRR0kzVzc2cEpmNXQ0MlBtTUtidHo4NThNTlkzVHNOSlVOd1g4WU9iNUNBc3JlVWpJdzRkUnFncDF1aG1qYkUtVnlYckl1STlxdThwanUyZV9CcHdvYkpCUVlYWnZuYnVzM0g3QmoyVlBsc1dOZFRQUXFrN0hFbDNxdHZoYWNHbzc4b2ZnV2pKc3dXNEpPYm9MSlFGYk54b21uM3JZSDNvVmJaUmcxWEpNY0ZCWXpiWGpSVjg5R1Y5SURORU9IdHp4MjhuSzRfZ0NfS3pKQ0tpMVVSazZNVHJ3Rmw2TkxDazY0eDFqX1puQk93dm5lMXlOLXpqa2NBb3hCeXdTVGJ1aGVIUV9NcDc5a3hnOXA1X0dKTW1leHZfMUZoTmF1VE5kRWJhS0R1S3EyQ2ROVFB0NVo0M0ozN2hwenBLdi1LZnRybGhIR2otZFM0dVp1N3BoVFBLS2hrQ1JfZFV2V1d5MlJDNlBWVGoxaFY4QkE4SzB5MXEyVldXSzJ4Zl9YbWJ6Ry1WclNSYjB3eW0yOE5hZGhDWVRjQjl1eXNuSDNC");
				cookieHeaders.Add("encrypted_key1C3", "aFRpcnRSOFBxcXlfa0RhdzZjVVJNVlZlZGxFZVdnZHQtSHMyWWhZRVh5X3EzRmRNN0xXUGdsNkhiRGlnSWYyX1h3NkpXanFlTlRWQ01hSHJWT29FSmF4MHJiWHJxT204TElCLVVCc2hTcnA2eGltdjBBUkxFRDVqWEhER0pnamhvall2V2d2UEduVXotQ2g4dmh3WWx3SE80ajRrVUpCY1FxZVFYenRicWlYSmMyS0I5ZnRYRHRlTG1kMDR0Vjd3LXhfaDIxZ2xwNTFwMXJmYXN2YXJtdXJFOEROVko0TGxSNEpGb2duenY3dHVuVndtTWcweTh1dEtHdWtEOWFhN05mWi0zVzZzckJibmZVY3JGV0g4R243NldEcTAzRVh3dVJNSm5nY0FoLWl2THZqQi0wXzY2Ty1sVkpLTFMxQS02eUxqM1hRY18wek5sWlc0amNuXzdLTGVQb1pIM1lheDZLbGk1X0JhSkJ0VVJLOUYtT3Q1akhpYlF1YjQteG5pZ2lCTWp5ckxwOHZHNzNiSjVSb3NmYUNaNXFvQ2tOLVBEZzliaFNFd1RqaFBDVnFOT0M0QnQ1T295bU42cXpzdkh3bUkxRmoyaDNIc3VZeEVFbmJkUUhjSXNIR3o1TkJGSHFOZWhoNnBXMmpoTW03Z0lKMnNCTFdVeFp6eldrTzg4dUMzRHFSVURUWDhwbUgwLWJGMU1yQllsOFYzODJBRGFQaUc5VG94LWVsU1B3ZTFITERzUE5BSnp2UVhsREhITGY5X01QOEZfNkFzT0VOcjl3QTR4dHVIRjRXY0JNTkFaenBIVlpVb21jMXlrNXdIaUVJb3RCT1F4Y1RZT0VoOXZpZ0xYZHJNZUxSQzNuSndUZmpqOVhHODU1SFRnY0F0VUp2OUE5Q0tDSHUybGtLb0NSZWZ5ckNpeGEzNkNoOVlKMTEzRndqbXR6OXAxc1FzZWZsRU50WU9oajFfRlBaVlVsN1UteU5XQUkzMGZhemg0MFRER2o5cWNhM0tsTGlQZkFvc0dUdW91elUwaC1QbWloVGZKSW1EbENiQzZCb2JnQQ==");

				cookieHeaders.Add("Key1", "chunks-2");
				cookieHeaders.Add("Key1C1", "%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");
				cookieHeaders.Add("Key1C2", "QbhYWs1yT36FaS3xVD16egInievyM2kWXjsgQRC3aWUvq3cq6wnI8hffXSGrRAGJ46JPUm0gBlWgXGoQWvQiKkz75CU5lvY643qVP68KQetff8E683geD523g6i3Qxa3V9dJRRP0uuCcC57W2AN7oWHf4OdDuNHNXQEd81n5QsRolGfjFP2GqJnprfHm9eX4pETsM0Rmdlwf0SFFThzgNn74WsJBB6HpNXlkfwJGM2sJM1xpzFJxHMLn0iQyDlXngRad3ttjqxkgwHHHArTRT0SCzdHYEcauiVuIZJVAHmOgy3WGilzRhLBQUdBYAPO3eO07whkuQhuN0rKQIsAgKAuBLwrMzYz38nejxJdA5mBnAqf0eoxBOVFnyGcCtQXzgM1GJT5hrx0yPzaq4ES1I3T0jTj5xtF2PJiZ2ZMO4iHhvvDQyIwy2ilLJdVKv02Nnr1H4IDB0xSLCvfDLVztw43C1SteP9KPiGSJiPjBkjsggTyBa44jARVZOMISZdda0he2TYFPYZkEuHxwjWpzfXLFil0pCnp8T6DgkEkPtgNeWRWFqhN3Y8f5gkomifSOtgeLOcKVaaPrD4e4pw1CvHRbxMrN0KneBpzzznkrAfyTXyuDAqAelfAm1qtmAihWk3EaqeGlgfj9ZfhI9IKr6V6IBUn1qt3OhX837Ta9mLrMtYfgmAw93UJv9hsyRRO50LD2VlwEMwgesv9uAjQUMI4KD008MKEqSbDrPh0iVf4bkaZwrSOZaFQBkTBazgHhd5RqG2l63dk9dMk8CWj7ipd3Z42UQd1dv5kv7HF44d4T326UX7MwXBIoUeIUwA76cAKsELdjkNBAy0NPoy0iym1bo4lWjzb3URTHA3MLkbOiAFi68Q4Tv124dl7LeRC4e6WsvOy89bL3txsrQ7Y4JAZ6xsRJdCSxAwakvF7xWAjGnKBrx2aZAmEgeyvyAEECzdITLArm3OvU9WKKlMd74244iOZaAQcSLh7ct1vd27XNms%22");
				return cookieHeaders;
			}
		}

		private static Dictionary<string, StringValues> cookieResponseHeaders
		{
			get
			{
				var respHeaders = new Dictionary<string, StringValues>();
				respHeaders.Add("cookiemanager_1", "cookiemanager_1=test1234; expires=Sat, 02 Sep 2020 23:19:18 GMT; path=/");
				return respHeaders;
			}
		}

		private HttpContext httpContext { get; set; }

		private ICookie setupICookie()
        {			
			//Mock IHttpContextAccessor
			var mockHttpContextAccessor = new Mock<IHttpContextAccessor>();
			Mock<IDataProtector> mockDataProtector = new Mock<IDataProtector>();
			Mock<IDataProtectionProvider> mockDataProtectionProvider = new Mock<IDataProtectionProvider>();
			var cookieOption = new Mock<IOptions<CookieManagerOptions>>();
			var context = new DefaultHttpContext();
			
			
			//setup httpcontext
			mockHttpContextAccessor.Setup(_ => _.HttpContext).Returns(context);
			//setting up cookie collection
			mockHttpContextAccessor.Setup(_ => _.HttpContext.Request.Cookies).Returns(new RequestCookieCollection(cookieRequestHeaderList));

			mockHttpContextAccessor.Setup(_ => _.HttpContext.Response.Cookies).Returns(new ResponseCookies(new HeaderDictionary(cookieResponseHeaders), null));

			//setting up set-cookie headers
			mockHttpContextAccessor.Setup(_ => _.HttpContext.Response.Headers).Returns(new HeaderDictionary(cookieResponseHeaders));

			httpContext = mockHttpContextAccessor.Object.HttpContext;

			//setting up dataprotector
			
			mockDataProtector.Setup(sut => sut.Protect(It.IsAny<byte[]>())).Returns(Encoding.UTF8.GetBytes("CfDJ8GnPj9ak8t1HphXa8mMbIoKnqw4YPtXOXoKasvmnPEhKDWkKreGRYzObYb6nsYj6zcIIiyuqWMic_lfwLkYv-Y-II7heGvYx0ffMSSIVD7JKrsX9ML74Ju2vmFPnhTtifbnFQBrUbluhJ2Pn34v3anAXHdYRTh2YlyJhJ3oJDUru_6xO_7EM9UJdwxU9VJOf0NpChZypR9Aa64JQX4CLx8i4Sy04gzxsKKvSq0TACNlY1RuW8fodu23osFIsIdQ96G2vIYwOyueFUXA2tcLCurbtm2kQGgqviZZoBQNdfiwTjxw6dvW5f9MmJHz_XpbQCYiEU8kG15DkyWglvq006C6A9xcCGvi6Fi0_Ow1gVhwSdvHun7M9vpNF9BWojdpdOwTD2y9nSjg3adU1IRml-zZxPJ0LVICVQ0yZ1ZnbqWfMxSVueoeEGVYoIu4h_EqT-Y6YqmSx0-Z5yOjK5AJauARFoU-5ho6yCSUIg_sdbhkRecFM0oChqfCFvjPl_T2irTUk2EO94FrC7TGZ-vM7VPs2F4_J7Td2IyaZBvwyGFL6A_Xp8MGoOoAgWUgBL4t-o8JscOLgVrGyBffQtM92sg6bsqEnrxerO4sE1QTxDF_TpCD5sLKMtaF3NItukOfVt9DPaTV9THgue6LVJFasotqv6b9UOd_o2Tpa_ZB0LHxhdZNRHYRqF0HcyCohphsRIJ5hCP5Os7DIT8isyYks_ZXKEmFd7TKTREVouO3T1EPx0bDV_qFGBZrQu6V_uybf7gNk9Crnge2Ekj6ElXgPIviauc7edKVnPsTRzwDsOYN1NWgk-UGkKFjISCrE_UkaMn8F6-y2umgVJTebmap-MczZq6eilD9r_7aDSJyZBIZPY0QdGSJlLx3CYySTJ0fsoz3t5sUlt1cuAeWng6oiE_ij0wbUfriP8YE1mF8RB8hSQtVXC3KH8_ukP2ofEuehzvm_NTRx5yKls4nkfnzaUpfU3VYvVUIuLWnQY5xeCnN2xn1Qgklbfv_Xx32ZEKAGmm6HxKkqlrz8y-WFUdrYcI4ng2EJvvt0B2IUopCL_DPEAh4sXmEy0pM_YOtOV_mCH4eMupKAD0tqBuTFrYeb85vsNqe4SOKkYTID83KtVxZ0fCo6Z4Gd6kLHQ4TQRokVnkHa1c9VHrzZKI6oy23uGwAyVGlFxTK4lM6Xg2HBjo_AYrxg5H6Yb3Kb1M188hImXvW8q6H-C7LMwM966FGTv1kOYYCPFxL-4876UziUcAw7hQGAoxCRZQVOmd7-K8DtQSeI4ctRzaghduMlYAbqG5s5ZerhUF-1Jbo3d4RTOxXdeH9l8D7St2WfHn1aObitZ8tPxY90V4y5YmOQbC267W9QaQUT0pcw7es6SZDbrNmxp6ktzxn34qcAkINmBnMTJKohl7tXCs3mJsXc7mpEeeFjy4NXa8f3pKKQ_hv4Qkfl-gOgfnFTQe6tD9VAQMdUQbjh_R4NoKaRGnRQTHSWBn4dHFQSWwSyshHbvyq8rXB4eRbB1yb5WD4BdpWVNa2d2k2NU1jZy_FI4SZoKsO-H5gPl3j6xnvyk20swbBE2RdLG_SGEWUNMYUdJEOxgH7FC3amwh3-MGhxwJ6m0maGukIL_uAjbH7N_Yt7pf1c5WNWbfQEGkhw3KBIf_vrbr4USZt_0zGWvFM64IXvJl8D5JNvsuVlOrrihfv0TMjhcmFinYM40FSVg3R9qkGHK-kftfYCxK_hoOrxkETEcNZfcE9sgr5F2abXqDM_nhExF35brEt3jrNRJb5DTFV9DV7VidQfec8qjF-c6UTosoa6hgkK2LCeriZ7x3olFjkeUSW501bYDDEJjcphMA5nr1HKsuPt1C9OR3O5UhPwR_quYKQRnbqvPbfljKlBIy0rzVUVVEoZz58vpoDC96di-L-TRLUVPFlukY5k43P5mFLRkWiMZ3GFz88qdOKM_AtPdc-Vi4r77h-fdzvtW5sBiBQ54ViAqHW592XRVjQZHx6_UFyT9rqVgVgjSn_PAJ9Nqv-1S4V30DT4QmgYhLb_UW8oyB7q4dAXPiQWz26LRkPRR-93fl-XiIYTm0TMTv3yT8p51Sl4LaPmJwlPSszPgziEnZET1ypX3xMaJ8oIBEakk5uAnvdToHintIN6a3z6L7Aon0DlEvfrUOvf7cTXtDrfrJx-6NX7Bkj5W2R24_QFTR-rst6gXNQJzBCU9H5ml9m8WVapWX25g4oADScfg72FiTAHBLn2T1lC16YncicOLsyK2jxvXtJ716ECq6b3Lv6lvuHkB_vWQYSpRCsnJnmDjWebUao11WhpwaqgDiDyGAgQpsSWKdMch8hpSK9911LWIc29lXozwb73igIvekGKIZRER9ZdxFiEnF5SggQyChvWsLW-SSSyaKd5nvcLO4PCJTjDAlkym7FIZWpHtqGvr_wGLPq_oFQ6nsy1AWn8gg6fVd6Zn4hqvan8_FEwJz44UTXJoG6s_IJns4SbivRyNnyByfGPr8ytzDUQ0fcCmtEJABu9SNr575q9-YuZr-6qa5bzDMtt7PAqSvrcI7z2IWW8quKmf5wD_u74rCuVfQk8aLxqxBb-yoJx-OGhWMAHO1Sxl5wW_MKkYeJvwJjC9vOang1aq_Rcpb0xnPEz5uhjJIUiugFdpL34-mjNyA4dXRHsHiUuOOHTg2tYnyaLZ5Lm1wjmjxv1PT3ks2_d17QHjbBiquE1Bz3k2k0KMvrl9PFqrvrVxBdUq8AFYI-43XpAuJGu2QpxmFcTTz1d5MKgCdfX2hqX3wbg0ehUcEEGHkZE0kjOcnOr2MGb_U9rutEYy4nmUWSIEubrBVFSIJ1vXUua0j7-q9_Zc7per08akEGqCMxxzTXsWxgAAetFb-X-PKNC03SC3KhrFvZu7VlRJUetOb75Vfjhtpv9iSKRhvnlOSDmki5iAlP7jViQdZCeQGI3jSS4734dnRbB44J3WustkK5sj33o0U7gOWTuXtm2KqTDhjMPU5-FdxKKVVd9u4SF71PP2aNfiYv4V14kAB4IVV3qjINz3XUdPRsJK3C8XoNdwJeZTJvQGCIkw7wXNfTC5i634c7c98CT6X2I4d-q2s8HvjLRD9gvTEUE-E0A4GEMWhFwCqfhR0MfRmYKo-OJq6JGz6Z6QqolN4toTGjBJVUhVRMKTyg7g5fJcjYQPLp3gOLpsLd2z0silP1jH9NMI85eGf5_Pp7DSA_aGiwR6nfzgSerJWyCLHlUHK0_vLz0s0rB2u4xtsdttZ1JeIUqlHHcSokzxTLn3cAZ4QfjufMOiWNxcSUKRdt9fMCW4A7ncVEJpraLkJcfEYiE5XVPM_cYL0O6cZQdkJLo8PssIiVz7VWHM6nfnqVb2ILQf0ccuS4_O-HrPo4yMM_Tx5eYbVVXesYUEdQ8fRo34SqFT7i1p5h8kRJGU2xBSUzyKTQxZyzuXqoW5nSj9FMyrHp3hbawKVYbAcX7__GdZ7LjVWiMvRDjhLUpvzGUSBNLQ7OeAM1-ElGwXxyD_T_HWxykpl7q0m1F6hnU-j1Kg4zMFoPSSEYqlQxx_odRrvzhfq2EpiyUeT82V_PjkIVj42s3SEYOqTvLWwGZvTIvLsEzUX4vMoSjpWH3ZBNT-mVw7EY_QRxTe-rughjccvUtS3XBquMfNt7UGW7hWWYUeFmpbbdwy4gWaOH3NCuom-zoHE3XcNrTvamdNDnko-gxMDtd7b90Rbzd-MCXukS6qFqa4sePFY3drMmgD1uz-Rhti3MrtSjC9jiCu98vQKJulf06079XeJffMCcGIyk7GUD_jfFLVeJ4yK3chTz90o5PoS7lpxqbzTTWBoWZA9TcWspXmOTm2p5g49YOHHfDfYRyjXCDDJPnaxRBHYroZrwZP7NjsOQTU8XZCTmmZiRe9EMnGJJBo7B4vKKbM5zmj3czp9ydwOfQamSvM1_YdfVybsa1mpfzIXY_xMenGBvTxCQsZEshhAcoWzC1X1ZoMzilLGxgEct70uXzsuK90HZwbIyynme03hTK4l4vTH1qMjBNti-VnhxiHWKf1zAjRj7g-islGDRgf9mos5wzJ0_FRobCEISuhhKSk3KqNCd4rCAyoJOz_yw8aISP_DzHmCzESdV7ykuOtqjAfkODDL29RyMEpR81Q_ihoD-kIor8xi4pNevAmqpr6EMYN4sweiH6SsZSeh5fCDU5MMRIxipw5w-_9bU6A9XBwYTe5AbCBfcauiCnGzS7ZP0Uxyg7euT2652U6QvcTn2lhHlovL7FCMs19nIXsTBkgNVdHlH7rm_Mi1VAW_lqBBI7rVV0juKITvZIeUrkjfVOhh0ZdeX0dVjp_WPU2BimWiZk_rWG98JSI3zrJFAyJBTj2jIefzueE6kSkQuc3O9uUZWfptLkmmRcKTwQ8piTdQagWxIZ_pNOJo5cLkeLncbA2nbQfuwdNFhprNs65MYa3Q8tZby9sAvbqeY3o3t1Q9ZOF0TNE509kpceZyaWU35eulK8mA3VcGyTGBcNxtCih8T0d1RNzUzlaqpgrsPZEeLJuS6XBr1TPeLMOKGI4a2gdsLKAU7Ce1rAQ-BBcYv_RS_YsFL_FyHSr0QTzE301-TPaowcJQQb7bTDaFgFc9bttDVpOUgm6Zh20-91af2HIw2H-BVjn0Y7uBwFEADo9nIU2cCtWelvvMzGqReBWXRsr2pftwJtbrZozMf2eSniyUzXXd7zYQaSc-WkiejeIA9quvKvaybK2RVldCqP_TF8SaBpDrmboaxFGaSwdsc6L5_apwLkv3MxTx113J1NqqCinYKxjWsNV6wJ2NLiJdEzBkblwNSwSwf2JVfzGvcSEEfHxdNhXvPs7u3iqe1U2hDCyD82GismNhWsdd8k5WtvJ45rlrq7F2ERCe33lqjIp7PwXjhWpfA6WI9OM5Yhnak5Kv-lWQMVnwnrQnOn7vfnw5DwItGgAKFtdHyYSzl0bRB_t4Rb4K8TdVI3vfaT6aPemrHb7IHGQhFlRBceFDQ06nJU9lvmz0lKhXs-oi7EsWSe2KGFHIU76FEiTQEfQmDIaj1tdXqrDlBBVLpi9W9PWtQfQjkGQEmLriln5MRrmwD7BAqw__oiCpkebgONRp1pNvS-TebsmzXgrlrVXHCiKJuLuD_dN5Lkr8m5XSRomqj-yBzVlCHtZTEkDhRiZ7hzcHTE58eJrForozyMMzkgo4ri9M4gWOx8EzE54XmhtRvQu1IzL_O3yBDQyArjqS6xUcv_TVlc9gWsCr3I2S0A7C7EGe2J8195Y363AT-g7tix4CxKGseEHY8SMrtSgngE00wiqsru7R2XMW4QjAZ13ZBOTlqf_qb2DADXKNVl7hFlc27GyQCSihriKJY5P-xizFuq-OStOrKT7VqypP5_hE8uOU0v22k6tzanU7xdeDF8s8S9rw6tKdea038jbr72J94V9KRXwHwoP8zsfw3mbSPMxrkEC0D-7UmkjQMcOYHaWn40cwtUX7B6gRU93AQy7sa8rOdoNHbrNbuuSUmwIMwQn0TEBG6ZDGesIn7yKeBopUip-MAzh3PrHQ8hYZ32hQGI3W76pJf5t42PmMKbtz858MNY3TsNJUNwX8YOb5CAsreUjIw4dRqgp1uhmjbE-VyXrIuI9qu8pju2e_BpwobJBQYXZvnbus3H7Bj2VPlsWNdTPQqk7HEl3qtvhacGo78ofgWjJswW4JOboLJQFbNxomn3rYH3oVbZRg1XJMcFBYzbXjRV89GV9IDNEOHtzx28nK4_gC_KzJCKi1URk6MTrwFl6NLCk64x1j_ZnBOwvne1yN-zjkcAoxBywSTbuheHQ_Mp79kxg9p5_GJMmexv_1FhNauTNdEbaKDuKq2CdNTPt5Z43J37hpzpKv-KftrlhHGj-dS4uZu7phTPKKhkCR_dUvWWy2RC6PVTj1hV8BA8K0y1q2VWWK2xf_XmbzG-VrSRb0wym28NadhCYTcB9uysnH3BhTirtR8Pqqy_kDaw6cURMVVedlEeWgdt-Hs2YhYEXy_q3FdM7LWPgl6HbDigIf2_Xw6JWjqeNTVCMaHrVOoEJax0rbXrqOm8LIB-UBshSrp6ximv0ARLED5jXHDGJgjhojYvWgvPGnUz-Ch8vhwYlwHO4j4kUJBcQqeQXztbqiXJc2KB9ftXDteLmd04tV7w-x_h21glp51p1rfasvarmurE8DNVJ4LlR4JFognzv7tunVwmMg0y8utKGukD9aa7NfZ-3W6srBbnfUcrFWH8Gn76WDq03EXwuRMJngcAh-ivLvjB-0_66O-lVJKLS1A-6yLj3XQc_0zNlZW4jcn_7KLePoZH3Yax6Kli5_BaJBtURK9F-Ot5jHibQub4-xnigiBMjyrLp8vG73bJ5RosfaCZ5qoCkN-PDg9bhSEwTjhPCVqNOC4Bt5OoymN6qzsvHwmI1Fj2h3HsuYxEEnbdQHcIsHGz5NBFHqNehh6pW2jhMm7gIJ2sBLWUxZzzWkO88uC3DqRUDTX8pmH0-bF1MrBYl8V382ADaPiG9Tox-elSPwe1HLDsPNAJzvQXlDHHLf9_MP8F_6AsOENr9wA4xtuHF4WcBMNAZzpHVZUomc1yk5wHiEIotBOQxcTYOEh9vigLXdrMeLRC3nJwTfjj9XG855HTgcAtUJv9A9CKCHu2lkKoCRefyrCixa36Ch9YJ113Fwjmtz9p1sQseflENtYOhj1_FPZVUl7U-yNWAI30fazh40TDGj9qca3KlLiPfAosGTuouzU0h-PmihTfJImDlCbC6BobgA"));
			mockDataProtector.Setup(sut => sut.Unprotect(It.IsAny<byte[]>())).Returns(Encoding.UTF8.GetBytes(expectedTestString));
			
			mockDataProtectionProvider.Setup(s => s.CreateProtector(It.IsAny<string>())).Returns(mockDataProtector.Object);
			
			//setting up cookie options
			cookieOption.Setup(s => s.Value).Returns(new CookieManagerOptions());

			ICookie cookie = new HttpCookie(mockHttpContextAccessor.Object, mockDataProtectionProvider.Object, cookieOption.Object);			
			return cookie;
		}

		[Test]
		public void Cookie_ContainsTest()
		{
			ICookie cookie = setupICookie();
			Assert.True(cookie.Contains("cookiemanager_1"));
			Assert.True(cookie.Contains("cookiemanager_5"));
		}

		[Test]
		public void Cookie_GetTest()
		{
			ICookie cookie = setupICookie();
			var expectedValue1 = cookieRequestHeaderList["cookiemanager_1"];
			var expectedValue5 = cookieRequestHeaderList["cookiemanager_5"];

			Assert.AreEqual(expectedValue1, cookie.Get("cookiemanager_1"));
			Assert.AreEqual(expectedValue5, cookie.Get("cookiemanager_5"));
		}

		[Test]
		public void Cookie_GetPlainChunksTest()
		{
			ICookie cookie = setupICookie();			
			string actualString = cookie.Get("cm_key1");
			Assert.AreEqual(expectedTestString, actualString);
		}

		[Test]
		public void Cookie_GetEncryptedChunksTest()
		{
			//TODO getting null value of data protector
			ICookie cookie = setupICookie();
			string actualString = cookie.Get("encrypted_key1");
			Assert.AreEqual(expectedTestString, actualString);
		}

		[Test]
		public void Cookie_SetCookieTest()
		{
			//TODO getting null value of data protector
			ICookie cookie = setupICookie();
			string expecteSetCookie = cookieResponseHeaders["cookiemanager_1"];
			cookie.Set("cookiemanager_1", "test1234", new CookieOptions() { Expires = new DateTimeOffset(2020,09,02,23,19,18,TimeSpan.Zero)});
			var actualString = httpContext.Response.Headers["cookiemanager_1"];
			Assert.AreEqual(expecteSetCookie, actualString);
		}
	}
}
